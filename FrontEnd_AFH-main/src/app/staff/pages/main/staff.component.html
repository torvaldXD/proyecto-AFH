<body>
  
  <!-- SIDEBAR -->
  <section id="sidebar">
    <div style="padding-bottom: 20px;" class="boxIcon">
      <img src="../../assets/Logoafh.png">
      <p>AFH<br>METALMECANICOS</p>
    </div>
    <ul class="side-menu top">
      <li>
        <a [routerLink]="['/home']">
          <i class='bx bxs-dashboard' ></i>
          <span class="text">Inicio</span>
        </a>
      </li>
      <li class="active">
        <a [routerLink]="['/staff']">
          <i class='bx bxs-group' ></i>
          <span class="text">Usuarios</span>
        </a>
      </li>
      <li>
        <a [routerLink]="['/quotes']">
          <i class='bx bxs-file' ></i>
          <span class="text">Cotizaciones</span>
        </a>
      </li>
      <li>
        <a [routerLink]="['/tools']">
          <i class='bx bxs-wrench' ></i>
          <span class="text">Herramientas</span>
        </a>
      </li>
      <li>
        <a [routerLink]="['/employes']">
          <i class='bx bxs-user-account'></i>
          <span class="text">Empleados</span>
        </a>
      </li>
      <li>
        <a [routerLink]="['/clients']">
          <i class='bx bxs-user-detail'></i>
          <span class="text">Clientes</span>
        </a>
      </li>
      <li>
        <a [routerLink]="['/supplies']">
          <i class='bx bxs-package' ></i>
          <span class="text">Suministros</span>
        </a>
      </li>
      <li *ngIf="userLocalStorage.area === 'GERENCIA' || userLocalStorage.area === 'LOGISTICA'">
        <a [routerLink]="['/history']">
          <i class='bx bx-clipboard'></i>
          <span class="text">Inventario</span>
        </a>
      </li>
    </ul>
    <ul class="side-menu">
      <li>
        <a [routerLink]="['/configuration']">
          <i class='bx bxs-cog' ></i>
          <span class="text">Configuración</span>
        </a>
      </li>
      <li>
        <a style="cursor:pointer" (click)="this.storageService.logOut()" class="logout">
          <i class='bx bxs-log-out-circle' ></i>
          <span class="text">Cerrar Sesión</span>
        </a>
      </li>
    </ul>
  </section>
  <!-- SIDEBAR -->

  <!-- CONTENT -->
  <section id="content">
    <!-- NAVBAR -->
    <nav>
      <i class="bx bx-menu" (click)="changeSidebar()"></i>
      <div style="width: 90%"></div>
      <a href="#" class="profile">
        <!-- <img [src]="img" /> -->
      </a>
    </nav>
    <!-- NAVBAR -->

    <!-- MAIN -->
    <main>
      <div class="head-title">
        <div class="left">
          <h1>Usuarios</h1>
          <ul class="breadcrumb">
            <li>
              <a>Usuarios</a>
            </li>
            <li><i class="bx bx-chevron-right"></i></li>
            <li>
              <a class="active">Home</a>
            </li>
          </ul>
        </div>
        <div style="padding-right: 5%;">
          <button  class="p-button-rounded-sm  p-mr-2" pTooltip="Acciones" tooltipPosition="top" pButton type="button" (click)="menu.toggle($event)" icon="pi pi-th-large"></button>
          <p-menu #menu [model]="items" [popup]="true" appendTo="body"></p-menu>
        </div>
      </div>
      <br>
        <p-toast [breakpoints]="{'920px': {width: '100%', right: '0', left: '0'}}"></p-toast>

        <div class="card text-center">
          <div class="card-header" style="padding: 15px;">
            <h3>Control de Usuarios</h3>
          </div>
              <p-table
              #dt
              [scrollable]="true"
              filter="true"
              [value]="users"
              [lazy]="lazy"
              [rowHover]="true"
              scrollHeight="300px" 
              [resizableColumns]="true"
              (onLazyLoad)="loadInventoryLazy($event)"
              [paginator]="true"
              [rows]="5"
              [totalRecords]="totalRecords"
              [loading]="loading"
              [showCurrentPageReport]="true"
              [resizableColumns]="true"
              [autoLayout]="true"
              [styleClass]="selectedSize"
              currentPageReportTemplate="Vista {first} a {last} de {totalRecords} registros"
              [globalFilterFields]="[ 'name','area','email']"
            >
            <ng-template pTemplate="caption">
                  <div class="p-d-flex">
                    <button type="button" pButton icon="bx bx-group"  pRipple class="p-button-rounded-sm p-mr-2" pTooltip="Total de Registros" tooltipPosition="right">{{this.total}}</button>
                    <h5 class="p-input-icon-left p-ml-auto"></h5>
                      <span class="p-input-icon-left">
                          <i class="pi pi-search"></i>
                          <input pTooltip="Filtra por:
                          Nombre , Area , email " tooltipPosition="top" pInputText  #textInput type="text" style="border-radius: 18px; height:45px;" (input)="dt.filterGlobal($any($event.target).value, 'contains')" placeholder="Buscar..." /> 
                      </span>
                  </div>
              </ng-template>
              <ng-template pTemplate="header">
                <tr>
                  <th pSortableColumn="name" style="min-width:15rem">Nombre Completo <p-sortIcon field="name"></p-sortIcon></th>
                  <th pSortableColumn="email" style="min-width:15rem">Email <p-sortIcon field="email"></p-sortIcon></th>
                  <th pSortableColumn="area">Área <p-sortIcon field="area"></p-sortIcon></th>
                  <th>Opciones</th>
              </tr>
              </ng-template>
              <ng-template pTemplate="body" let-user>
                  <tr>
                    <td>{{user.name }} {{user.lastName}}</td>
                    <td>{{user.email}}</td>
                    <td>{{user.area}}</td>
                    <!-- <td><p-tag [value]="supply.inventoryStatus" [severity]="getSeverity(supply.inventoryStatus)"></p-tag></td> -->
                    
                      <td >
                        <button pTooltip="Editar " pButton pRipple icon="pi pi-pencil"  class="p-button-rounded-sm p-button-success p-mr-2" (click)="updateUser(user)"></button>
                        <button pTooltip="Eliminar "  pButton pRipple icon="pi pi-trash"  class="p-button-rounded-sm p-button-danger p-mr-2" (click)="deleteUser(user)"></button>
                    </td>
                  </tr>
              </ng-template>
              <ng-template pTemplate="summary">
                <div class="flex align-items-center justify-content-between">
                    En total hay {{total ? total : 0 }} Usuarios.
                </div>
            </ng-template>
          </p-table>
      </div>
      <p-confirmDialog acceptLabel="Si" [style]="{width: '450px'}"></p-confirmDialog>
    </main>
    <!-- MAIN -->
  </section>
  <!-- CONTENT -->
</body>